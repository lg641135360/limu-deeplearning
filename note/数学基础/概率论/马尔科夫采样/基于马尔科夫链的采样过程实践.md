### 采样过程实践与分析

* 用python工具进行采样：需要采样的目标分布是[0.3888.0.2777，0.3333]
* ![image-20230410105409021](%E5%9F%BA%E4%BA%8E%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E9%93%BE%E7%9A%84%E9%87%87%E6%A0%B7%E8%BF%87%E7%A8%8B%E5%AE%9E%E8%B7%B5.assets/image-20230410105409021.png)
* 运用基于马尔科夫链的采样方法对目标分布进行采样，统计最终各个状态中样本的实际比例

### 代码分析

* ![image-20230410110346557](%E5%9F%BA%E4%BA%8E%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E9%93%BE%E7%9A%84%E9%87%87%E6%A0%B7%E8%BF%87%E7%A8%8B%E5%AE%9E%E8%B7%B5.assets/image-20230410110346557.png)

* ![image-20230410110357140](%E5%9F%BA%E4%BA%8E%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E9%93%BE%E7%9A%84%E9%87%87%E6%A0%B7%E8%BF%87%E7%A8%8B%E5%AE%9E%E8%B7%B5.assets/image-20230410110357140.png)

* ![image-20230410110430415](%E5%9F%BA%E4%BA%8E%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E9%93%BE%E7%9A%84%E9%87%87%E6%A0%B7%E8%BF%87%E7%A8%8B%E5%AE%9E%E8%B7%B5.assets/image-20230410110430415.png)

```python
import numpy as np
from scipy.stats import uniform
import random


# 当前状态、转移状态矩阵
# 返回转移后状态
def randomstate_gen(cur_stat, transfer_matrix):
    uniform_rvs = uniform().rvs(1)  # 均匀分布，生成一个随机数
    i = cur_stat - 1
    if uniform_rvs[0] <= transfer_matrix[i][0]:
        return 1
    elif uniform_rvs[0] <= transfer_matrix[i][0] + transfer_matrix[i][1]:
        return 2
    else:
        return 3


transfer_matrix = np.array([[0.7, 0.1, 0.2],
                            [0.3, 0.5, 0.2],
                            [0.1, 0.3, 0.6]], dtype='float32')
m = 10000
N = 100000
# 任取一个初始状态
cur_state = random.choice([1, 2, 3])
state_list = []

for i in range(m + N):
    state_list.append(cur_state)
    cur_state = randomstate_gen(cur_state, transfer_matrix)

# 切片，保留m之后的N的状态
state_list = state_list[m:]
print(state_list.count(1) / float(len(state_list)))
print(state_list.count(2) / float(len(state_list)))
print(state_list.count(3) / float(len(state_list)))

# res
0.39006
0.27654
0.3334
```

### 基于马尔科夫链采样的过程总结

* 首先，寻找以目标分布pi为唯一平稳分布的马尔科夫链，找到他的转移概率矩阵P
* 其次，设定燃烧期m和稳定期N，随机初始一个状态，基于转移概率矩阵，在状态间进行m+N次随机游走，并记录每次转移的状态
* 最后，丢弃前面m次燃烧期采样得到的状态，只保留后面平稳期的N次采样结果，这N次采样结果就近似于目标分布Pi的采样