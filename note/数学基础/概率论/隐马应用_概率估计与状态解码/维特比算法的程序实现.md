### 代码演示

![image-20230408110342093](%E7%BB%B4%E7%89%B9%E6%AF%94%E7%AE%97%E6%B3%95%E7%9A%84%E7%A8%8B%E5%BA%8F%E5%AE%9E%E7%8E%B0.assets/image-20230408110342093.png)

* 解码观测序列O={黑，白，黑}，求最有可能得隐状态序列

```python
import numpy as np
from hmmlearn import hmm

states = ['box1','box2','box3']
observations = ['black','white']
start_probability = np.array([0.3,0.5,0.2])
transition_probability = np.array([[0.4,0.4,0.2],
                                   [0.3,0.2,0.5],
                                   [0.2,0.6,0.2]])
emission_probability = np.array([[0.2,0.8],
                                 [0.6,0.4],
                                 [0.4,0.6]])

model = hmm.CategoricalHMM(len(states)) # MultinomialHMM change name to CategoricalHMM
model.startprob_ = start_probability
model.transmat_ = transition_probability
model.emissionprob_ = emission_probability

# 0,black 1white
observation_list = np.array([0,1,0])
logprob,box_list = model.decode(observation_list.reshape(-1,1),algorithm='viterbi')

print(box_list)
for i in range(len(observation_list)):
    print(states[box_list[i]])
    
# res
[1 2 1]
box2
box3
box2
```

