> 部署时，有各种不同的场景，其图像的样子不同
>
> 扩大数据集，能适应不同场景的训练
>
> 增强训练出的**模型的泛化性**

##### 数据增强

* 增加一个已有的数据集，使得有更多的多样性

  * 在语言中加入各种不同的背景噪声
  * 改变图片的颜色和形状

* 使用增强数据训练

  * ![image-20211013110158738](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013110158738.png)
  * 在线随机生成一张图片
  * 类似作用在训练过程中的正则项

* 增强方式

  * 翻转
    * ![image-20211013110312119](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013110312119.png)
  * 切割
    * 从图片中切割一块，变形到固定形状
      * 随机高宽比 `eg`:[3/4,4/3]
      * 随机大小 `eg`:[8%,100%]
      * 随机位置
    * ![image-20211013110426545](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013110426545.png)
  * 颜色
    * 改变色调，饱和度，明亮度	`eg`:[0.5,1.5]
    * ![image-20211013110601161](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013110601161.png)
  * 很多种，不细说，反正就是调库的事

  

* 代码实现

  * ![image-20211013110833609](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013110833609.png)
  * ![image-20211013110842104](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013110842104.png)
    * `arg1`：给定图片
    * `arg2`：图像增广方式
    * `arg3 and arg4`：共同决定生成多少个结果 这里是`2x4=8`个结果
    * `arg5`：大小，忽略，显示图片大小，无关紧要
  * 左右翻转图像
    * `apply(img,torchvision.transforms.RandomHorizontalFlip())`
    * ![image-20211013111211995](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013111211995.png)
  * 上下翻转图像
    * `apply(img,torchvision.transforms.RandomVerticalFlip())`
  * 随机裁剪
    * ![image-20211013111330631](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013111330631.png)
    * `arg1`：最后图像尺寸
    * `arg2`：最后保留原始图像的多大范围
    * `arg3`：高宽比
  * 随机更改图像亮度
    * ![image-20211013111536838](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013111536838.png)
  * 随机更改亮度（brightness）、对比度（contrast）、饱和度（saturation）和色调（hue）
    * ![image-20211013111728862](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013111728862.png)
    * 每次从四个参数中随机取出4个随机值
  * 组合多种图像增广方法
    * ![image-20211013111832152](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013111832152.png)
  * 训练
    * ![image-20211013111858969](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013111858969-16340951394331.png)
  * 实际上只是用随机左右翻转
    * ![image-20211013112007128](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013112007128.png)
    * 从实际的使用场景出发，如果场景在光线上没有大变化，就不要对图像光线属性进行增广
  * 定义辅助函数，便于读取图像和应用图像增广
    * ![image-20211013112153691](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013112153691.png)

  * 定义函数，使用多`gpu`对模型进行训练和评估
    * 略过
  * 定义训练函数
    * ![image-20211013112337505](%E5%9B%BE%E5%83%8F%E5%A2%9E%E5%B9%BF.assets/image-20211013112337505.png)

